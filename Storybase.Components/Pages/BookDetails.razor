@page "/bookdetails/{Id:int}"
@inject IApiRepository apiRepository

<MudGrid Spacing="2" style="padding:20px">
    @if (isBusy)
    {
        <MudProgressCircular Indeterminate="true" />
    }
    else
    {
        <MudItem xs="12" sm="6" Class="align-center justify-center">
            <img src="@book.CoverImageUrl" alt="@book.Title"
                 class="align-center justify-center"
                style="max-width:400px; width:100%;object-fit:fill;" />
        </MudItem>
        <MudItem Class="justify-center align-start" xs="12" sm="6">
            <MudStack Spacing="4">
                <MudText Typo="Typo.h3">@book.Title</MudText>
                <MudText Typo="Typo.h4">@book.Writer.Name</MudText>

                <MudDivider/>
                <!--Buttons for actions for the book-->
                <MudStack Row="true" Spacing="3">
                    <MudIconButton Icon="@Icons.Material.Filled.HeartBroken"
                    Size="Size.Large"
                                   Ripple="true"
                                   Variant="Variant.Text"
                                   Color="Color.Secondary" />
                    <MudIconButton Icon="@Icons.Material.Filled.AddTask"
                                   Size="Size.Large"
                                    Ripple="true" 
                                    Variant="Variant.Text"
                                   Color="Color.Secondary" />
                    <MudIconButton Icon="@Icons.Material.Filled.Share"
                                   Size="Size.Large"
                                   Ripple="true"
                                   Variant="Variant.Text"
                                   Color="Color.Secondary" />
                </MudStack>


                <MudDivider />
                <MudText Typo="Typo.body1">@book.Summary</MudText>
            </MudStack>
        </MudItem>
    }
</MudGrid>


@code {
    [Parameter]
    public int Id { get; set; }
    bool isBusy = false;
    private Book book = new Book();

    protected override async Task OnParametersSetAsync()
    {
        await base.OnParametersSetAsync();
        await LoadBook();
    }

    private async Task LoadBook()
    {
        isBusy = true;
        book = await apiRepository.GetBookByIdAsync(Id);
        isBusy = false;
    }
}